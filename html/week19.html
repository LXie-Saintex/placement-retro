<html>
    <head>
        <title>Week 19 retro</title>
        <link rel="stylesheet" href="../css/basic.css">
    </head>
    <body>
        <h1>Week 19</h1>
        <ul>
            <li class="date">31th Aug - 4th Sep, 2020</li>
            <li class="team">Placement team: Sun Savers</li>
            <li>
                <p>Task: improve cleanup of dev env - terraform <a href="https://nidigitalsolutions.jira.com/browse/SVRS-2512">https://nidigitalsolutions.jira.com/browse/SVRS-2512</a></p>
                <p>what I've learnt</p>
                <ul>
                    <li>Shell script: error-handling</li>
                    <li>CircleCI: context</li>
                    <li>AWS SDK ðŸ˜²</li>
                </ul>
            </li>
        </ul>
        <article>
            <p>Things I enjoyed most this week: AWS SDK, writing up portfolio</p>
            <p>
               Finished my last task on Wednesday. The DNS endpoints on Route53 are now deleted, and no error is thrown when 0 records, but respective error messages show up if the records or characters amount exceeds the maximum limit.
               The terraform cleanup part of the ticket was singled out to be a different task, because according to Kristina, it turns out to be a bigger problem than imagined. Both the dynamic states files on S3 and the lock entries on DynamoDB need to be deleted,
               I guess, simultaneously as one without the other cause problems. I thought it'd be a good evidence for satisfying the standad point of speaking to Database so asked to work on this.
               Kristina also suggested another ticket to me that deletes an empty table in SQL <a href="https://nidigitalsolutions.jira.com/browse/SVRS-2310">https://nidigitalsolutions.jira.com/browse/SVRS-2310</a>
               , which I plan to work on if no one picked it up when I finished terraform cleanup.
            </p>
            <p>
                I spent the afternoons to work on the apprenticeship obligations, including first draft of portfolio and VQ. I have submitted the first draft and reached ~80% on VQ. I should be ready 
                to book exam early in the coming week. 
            </p>
            <p> 
                I wrote about 3 projects and benefited greatly from the process where I pieced everything together. VQ was pointless as usual but once in a while it surprises you with its coverage of random
                facts. 
            </p>
            <p>
                I feel deeply that Bash is the wrong tool for the tasks, especially the coming one where error-handling is more crucial. The code needs to guarantee that the state file and the corresponding lock entry are deleted
                around the same time (is that true?). It needs to be a sequential process where a failed attempt is retried until succeed, rather than skipped (or I could ignore the failure, collect all the failed ones and retry in a batch???).
                Shell scripts are impossible to test and becomes messy once the logic gets slightly complicated, partly because the code is not reusable unless exported as variables. I had to test the commands in the containers,
                which created many senseless commits (above 80). Here's another thing to look into perhaps, the commits were not really squashed when merging, even though I clicked on <code>Squash And Merge</code>.
                All ~80 commits showed up when I <code>git log</code>. Back to the topic, for testing in the containers, I had to repeatedly copy and paste the vars exported by the CI jobs, part of the shell scripts that authenticates, and finally the actual command that causes the problem.
                And how do I find out which commands are the troublemakers? Ta-da, the program exits when error occurs ðŸ™‚, so now I get to do the same thing all over again just to reproduce the environment. To avoid having the same experience with my current task,
                I tried to set up AWS authentication locally but I was not well supported by whoever was in charge ðŸ˜’.  In the end, I just asked Svetlin for the key and secret and decided to test the commands with AWS SDK for Go.
            </p>
        </article>
    </body>
</html>